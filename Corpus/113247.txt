Mail Bug on iOS, OSX, Opens Door to Phishing Attacks
A bug in the standalone mailÂ clientÂ for both iOS and OSX could enable an attacker to load external HTMLÂ and easilyÂ carry out convincing phishing attacks on unsuspecting users.
In fact, with a little HTML and CSS, an attacker could trick users into giving up their usernames and passwords, according to Jan SouÄek, a researcher based in Prague, Czech Republic.
SouÄek found the bug and reported it to Apple earlier this year, but after five months of radio silence and several software updates that failedÂ to address the bug, he decided over the weekend it was time to post proof of concept code for the issue.
My first GitHub repo is up. Hooray! Now go, Apple, and fix the bug ğŸ˜‰ https://t.co/nw2IXGx80U
â€” Jan SouÄek (@jansoucek) June 7, 2015
The issue lies in the fact that Appleâ€™s email client shows a HTML tag â€“ <meta http-equiv=refresh> â€“ that canâ€™t be ignored. By replacing the content of an email message and loading external HTML content, an attacker could tweak what the victim sees and prompt them for a password.
After findingÂ the bug in January, SouÄek Â filed a ticket (#19479280) with Apple via Radar, the companyâ€™s bug reporting tool. A few days later SouÄek Â added a video demonstrating the attack to the ticket, and eventually received a generic response from Apple stating the company doesnâ€™t discuss the security of their products.
The video showsÂ a popup in Mail rigged to like a legitimate login window. The window, marked â€œiCloud login,â€ is the same promptÂ that usually pops up when iOS users are experiencing activation/network issues. With this however, once a user enters their username and password, the information is forwarded along to the attacker, sight unseen.
SouÄek, who works in IT forensics, doesnâ€™t normally look for vulnerabilities, but claims he does like to â€œpoke stuff and see what happens next,â€ when reached by Threatpost Tuesday.
The issue actually borrows elements from a similarÂ inject vulnerability, CVE-2014-4925, that surfaced in January. That bug in Good, an enterprise app for iOS and Android, allowed an attacker embed HTML into email headers. This could have allowed an attacker to launch a browser session and connect a user to a malicious website upon the opening the email.
When SouÄek heard about the bug, he sniffed around Appleâ€™s mail client and discovered it was vulnerable to the same issue. He went on to use styles from Framework7, a mobile development framework, to mimic the native iOS modal dialog and theÂ proof of concept was born.
â€œWe are not aware of any customers affected by this proof of concept, but are working on a fix for an upcoming software update,â€ an Apple spokesperson told Threatpost Thursday, adding that the company is encouraging users toÂ activate two-factor authentication if they havenâ€™t already on their devices.
SouÄek believes it should be an easy fix.
â€œThe obvious solution would be to ignore the meta refresh tag, just like so many other html tagsâ€¦â€ SouÄekÂ said, adding that someone on RedditÂ was able to come up with a fix in all of five minutes. That fix, put outÂ by HASHBANG Productions, blocks any sort of navigation not invoked by the user and can only be added to jailbroken phones for the time being.
â€œI am all for private disclosures, but we always need to operate with an assumption that very few exploits are known only to the â€œgood guysâ€ before the hotfix is made available, therefore any longer period of inactivity by the vendor just puts more end users at risk,â€ SouÄek said.
â€œThere is no excuse for Appleâ€™s lack of action.â€
