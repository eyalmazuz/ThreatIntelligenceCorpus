Android Malware Toolkit Poses as Porn Apps Targeting Chinese-speaking Users
We recently discovered a malicious toolkit (detected as Android.Rootnik.B) masquerading as pornographic apps in the thousands, which are primarily targeted at Chinese-speaking users. This toolkit has a broad range of capabilities, including:
The apps find their way onto devices via app-centric websites, forums, and torrent sites. These can also spread over popular social messaging networks.
This malware hides its primary malicious payload in a fake .tiff image in the resources of the application. The payload downloads other malicious components from a set of helper web servers. The malware sets immutable flags (a technique laid out in a previous blog) to protect the files from being deleted by a savvy user or an antivirus application.
The threat also attempts to replace debuggerd, a key service that enables it to survive cleaning attempts by antivirus applications, or even more aggressive cleaning measures such as a factory reset.
The malware decrypts and dynamically loads the hidden payload (detected as Android.Reputation.1). It decrypts the following command and control (C&C) URLs and queries them to get root-relevant configurations:
The following is a sample response that tells the malware where to download the rootkits, when to start a root attempt, how many retry attempts to make if the attempt fails, and the metadata for the rootkit itself:
After gaining root privileges, the malware selects a good candidate process (such as a system process or an app-store process) into which it can inject malicious code.
The injected code launches a UNIX domain server socket, and listens for commands to trigger methods. Any malicious client entity (an app on the device) can now command the infected process to carry out malicious activities on its behalf, including sending premium-rate messages.
The malware also silently downloads and installs a known malicious app named ister59.apk (detected as Android.Reputation.3) from the following URL:
It can download and dynamically load other payloads from the following URLs without the user’s consent:
Moreover, it subscribes to premium services and sends premium text messages. It requests ads and pushes other malicious apps.
All devices with Android API level 8 (2.2) or greater are affected.
Even if some devices with higher platform versions cannot be rooted, the malware still sends premium-rate messages. In this case, the malware falls back to premium-rate scamming, as it cannot inject or install malware.
Furthermore, the malware code is highly modularized, which means it can be easily repackaged into any other popular apps. In addition, the malware is protected by a private packer, as outlined in a previous post. The malicious code is obfuscated and the key strings are encrypted, thwarting base-level forms of static analysis and detection.
Symantec recommends mobile users observe the following security best practices:
Symantec and Norton products detect the malware as well as related threats discussed in this blog as the following:
Martin is a member of Symantec’s Security Technology and Response team who are focused on providing round-the-clock protection against current and future cyber threats.
Martin is a member of Symantec’s Security Technology and Response team who are focused on providing round-the-clock protection against current and future cyber threats.
Shaun is a member of Symantec’s Security Technology and Response team where he is focused on security research, and innovation on mobile platforms.
Shaun is a member of Symantec’s Security Technology and Response team where he is focused on security research, and innovation on mobile platforms.
